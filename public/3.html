<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√©cile Pasteler√≠a | Men√∫ y Fidelidad</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cecile-cream': '#FDFBF7',
                        'cecile-gold': '#C5A059',
                        'cecile-navy': '#1A2E44',
                        'cecile-text': '#3E362E',
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        h1, h2, h3, .font-serif { font-family: 'Playfair Display', serif; }
        .loyalty-card {
            background: linear-gradient(135deg, #1A2E44 0%, #2A4562 100%);
        }
        .product-card:hover img { transform: scale(1.05); }
    </style>
</head>
<body class="bg-cecile-cream text-cecile-text min-h-screen pb-20">

    <!-- Navegaci√≥n -->
    <nav class="bg-white/80 backdrop-blur-md sticky top-0 z-50 border-b border-cecile-gold/10">
        <div class="max-w-md mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex flex-col">
                <span class="font-serif text-2xl text-cecile-navy leading-none">C√©cile</span>
                <span class="text-[9px] tracking-[0.2em] uppercase text-cecile-gold font-bold">Pasteler√≠a</span>
            </div>
            <button onclick="toggleCart()" class="relative p-2 text-cecile-navy">
                <i class="fas fa-shopping-bag text-xl"></i>
                <span id="cart-count" class="absolute -top-1 -right-1 bg-cecile-gold text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full">0</span>
            </button>
        </div>
    </nav>

    <main class="max-w-md mx-auto px-6 pt-8 space-y-10">
        
        <!-- Tarjeta de Fidelidad (C√©cile Rewards) -->
        <section id="loyalty-section">
            <div class="loyalty-card rounded-3xl p-6 text-white shadow-2xl relative overflow-hidden">
                <div class="relative z-10">
                    <div class="flex justify-between items-start mb-8">
                        <div>
                            <p class="text-[10px] uppercase tracking-widest text-cecile-gold font-bold mb-1">Miembro C√©cile</p>
                            <h3 id="user-display-name" class="text-xl font-serif italic">Invitado Especial</h3>
                        </div>
                        <i class="fas fa-crown text-cecile-gold"></i>
                    </div>
                    
                    <div class="flex justify-between items-end">
                        <div>
                            <p class="text-[10px] uppercase text-white/60 mb-1 font-bold">Puntos Acumulados</p>
                            <p class="text-4xl font-serif text-cecile-gold">125</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[10px] text-white/60 mb-2 italic">Pr√≥xima recompensa: 200 pts</p>
                            <div class="w-32 h-1.5 bg-white/10 rounded-full overflow-hidden">
                                <div class="bg-cecile-gold h-full" style="width: 62%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Decoraci√≥n -->
                <div class="absolute -bottom-10 -right-10 w-40 h-40 bg-cecile-gold/10 rounded-full blur-3xl"></div>
            </div>
        </section>

        <!-- Categor√≠as R√°pidas -->
        <section class="flex space-x-4 overflow-x-auto no-scrollbar pb-2">
            <button class="bg-cecile-navy text-white px-6 py-2 rounded-full text-xs font-bold whitespace-nowrap">Todo</button>
            <button class="bg-white border border-cecile-gold/20 px-6 py-2 rounded-full text-xs font-bold whitespace-nowrap">Milhojas</button>
            <button class="bg-white border border-cecile-gold/20 px-6 py-2 rounded-full text-xs font-bold whitespace-nowrap">Macarons</button>
            <button class="bg-white border border-cecile-gold/20 px-6 py-2 rounded-full text-xs font-bold whitespace-nowrap">Caf√©</button>
        </section>

        <!-- Men√∫ de Productos -->
        <section>
            <h2 class="font-serif text-3xl text-cecile-navy mb-6">Men√∫ de Hoy</h2>
            <div id="menu-container" class="space-y-6">
                <!-- Los productos se cargan aqu√≠ -->
            </div>
        </section>

    </main>

    <!-- Modal de Carrito -->
    <div id="cart-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-[100] hidden flex items-end">
        <div class="bg-white w-full rounded-t-[2rem] p-8 space-y-6 animate-slide-up">
            <div class="flex justify-between items-center border-b border-gray-100 pb-4">
                <h3 class="font-serif text-2xl text-cecile-navy">Tu Pedido</h3>
                <button onclick="toggleCart()" class="text-gray-400 text-2xl">&times;</button>
            </div>
            
            <div id="cart-items" class="max-h-[40vh] overflow-y-auto space-y-4">
                <!-- Items del carrito -->
            </div>

            <div class="pt-4 border-t border-gray-100 space-y-4">
                <div class="flex justify-between text-xl font-serif">
                    <span>Total estimado</span>
                    <span id="cart-total" class="text-cecile-gold">$0.00</span>
                </div>
                <button onclick="sendWhatsApp()" class="w-full bg-green-600 text-white py-4 rounded-2xl font-bold flex items-center justify-center space-x-3 shadow-lg">
                    <i class="fab fa-whatsapp text-xl"></i>
                    <span>Confirmar por WhatsApp</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Barra de Navegaci√≥n Inferior -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t border-cecile-gold/10 px-8 py-3 flex justify-between items-center max-w-md mx-auto z-40">
        <button onclick="setView('home')" class="flex flex-col items-center text-cecile-navy">
            <i class="fas fa-home text-lg"></i>
            <span class="text-[9px] uppercase font-bold mt-1">Inicio</span>
        </button>
        <button onclick="setView('menu')" class="flex flex-col items-center text-gray-400">
            <i class="fas fa-utensils text-lg"></i>
            <span class="text-[9px] uppercase font-bold mt-1">Men√∫</span>
        </button>
        <button onclick="setView('account')" class="flex flex-col items-center text-gray-400">
            <i class="fas fa-user text-lg"></i>
            <span class="text-[9px] uppercase font-bold mt-1">Cuenta</span>
        </button>
    </div>

    <script type="module">
        // Firebase Setup - Aqu√≠ pondr√°s tus llaves reales luego
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "TU_API_KEY",
            authDomain: "TU_PROYECTO.firebaseapp.com",
            projectId: "TU_PROYECTO",
            storageBucket: "TU_PROYECTO.appspot.com",
            messagingSenderId: "ID",
            appId: "APP_ID"
        };

        // Fallback para entorno de demo
        const config = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : firebaseConfig;
        const app = initializeApp(config);
        const db = getFirestore(app);
        const auth = getAuth(app);

        let cart = [];
        const WHATSAPP_NUMBER = "50377555213";

        // Datos del Men√∫ (Simulados hasta que llenes Firestore)
        const products = [
            { id: 'm1', name: 'Milhoja de Nutella', price: 4.50, category: 'Milhojas', img: 'https://images.unsplash.com/photo-1558301211-0d8c8ddee6ec?q=80&w=300' },
            { id: 'm2', name: 'Caja Macarons x6', price: 9.00, category: 'Macarons', img: 'https://images.unsplash.com/photo-1558961363-fa8fdf82db35?q=80&w=300' },
            { id: 'c1', name: 'Blue Matcha Latte', price: 3.95, category: 'Bebidas', img: 'https://images.unsplash.com/photo-1515823064-d6e0c04616a7?q=80&w=300' }
        ];

        // Cargar Men√∫
        const renderMenu = () => {
            const container = document.getElementById('menu-container');
            container.innerHTML = products.map(p => `
                <div class="product-card bg-white rounded-2xl overflow-hidden shadow-sm border border-cecile-gold/5 flex h-32">
                    <div class="w-32 overflow-hidden">
                        <img src="${p.img}" class="w-full h-full object-cover transition duration-500">
                    </div>
                    <div class="flex-1 p-4 flex flex-col justify-between">
                        <div>
                            <h4 class="font-serif text-lg leading-none mb-1 text-cecile-navy">${p.name}</h4>
                            <p class="text-[10px] text-cecile-gold font-bold uppercase tracking-widest">${p.category}</p>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="font-bold text-cecile-navy">$${p.price.toFixed(2)}</span>
                            <button onclick="addToCart('${p.id}')" class="bg-cecile-navy text-white px-3 py-1 rounded-lg text-xs">
                                <i class="fas fa-plus mr-1"></i> A√±adir
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        };

        window.addToCart = (id) => {
            const p = products.find(prod => prod.id === id);
            const inCart = cart.find(item => item.id === id);
            if(inCart) inCart.qty++; else cart.push({...p, qty: 1});
            updateUI();
        };

        window.updateUI = () => {
            const count = cart.reduce((acc, i) => acc + i.qty, 0);
            document.getElementById('cart-count').innerText = count;
            
            const cartItems = document.getElementById('cart-items');
            cartItems.innerHTML = cart.map(i => `
                <div class="flex justify-between items-center">
                    <div>
                        <p class="font-bold text-sm">${i.name}</p>
                        <p class="text-xs text-cecile-gold">$${i.price.toFixed(2)} x ${i.qty}</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <button onclick="changeQty('${i.id}', -1)" class="text-gray-300"><i class="fas fa-minus-circle"></i></button>
                        <span class="font-bold text-sm">${i.qty}</span>
                        <button onclick="changeQty('${i.id}', 1)" class="text-cecile-gold"><i class="fas fa-plus-circle"></i></button>
                    </div>
                </div>
            `).join('');

            const total = cart.reduce((acc, i) => acc + (i.price * i.qty), 0);
            document.getElementById('cart-total').innerText = `$${total.toFixed(2)}`;
        };

        window.changeQty = (id, delta) => {
            const item = cart.find(i => i.id === id);
            item.qty += delta;
            if(item.qty <= 0) cart = cart.filter(i => i.id !== id);
            updateUI();
        };

        window.toggleCart = () => document.getElementById('cart-modal').classList.toggle('hidden');

        window.sendWhatsApp = () => {
            if(cart.length === 0) return;
            let text = `¬°Hola C√©cile! üëã Quisiera hacer un pedido:\n\n`;
            cart.forEach(i => text += `‚Ä¢ ${i.qty}x ${i.name}\n`);
            const total = cart.reduce((acc, i) => acc + (i.price * i.qty), 0);
            text += `\n*Total estimado: $${total.toFixed(2)}*`;
            window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(text)}`);
        };

        // Inicio
        renderMenu();

    </script>
</body>
</html>